<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To-Do List</title>
</head>
<body>
    <h1>To-Do List</h1>
    <form id="addTaskForm">
        <input type="text" id="taskDescription" placeholder="Descrição da tarefa">
        <select id="assignedTo">
            <option value="João">João</option>
            <option value="Maria">Maria</option>
            <option value="Pedro">Pedro</option>
        </select>
        <button type="submit">Adicionar Tarefa</button>
    </form>
    <ul id="taskList"></ul>
</body>
</html>
<script>
    // Função para carregar as tarefas existentes
    function loadTasks() {
        fetch('/tasks')
            .then(response => response.json())
            .then(data => {
                const taskList = document.getElementById('taskList');
                taskList.innerHTML = '';
                data.forEach(task => {
                    const li = document.createElement('li');
                    li.textContent = `${task.description} (Atribuído a: ${task.assigned_to})`;
                    const deleteButton = document.createElement('button');
                    deleteButton.textContent = 'Deletar';
                    deleteButton.addEventListener('click', () => deleteTask(task.id));
                    li.appendChild(deleteButton);
                    taskList.appendChild(li);
                });
            });
    }

    // Função para adicionar uma nova tarefa
    document.getElementById('addTaskForm').addEventListener('submit', event => {
        event.preventDefault();
        const description = document.getElementById('taskDescription').value;
        const assignedTo = document.getElementById('assignedTo').value;
        fetch('/tasks', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ description, assigned_to: assignedTo })
        })
        .then(response => response.json())
        .then(() => {
            loadTasks();
            document.getElementById('taskDescription').value = '';
        });
    });

    // Função para deletar uma tarefa
    function deleteTask(taskId) {
        fetch(`/tasks/${taskId}`, {
            method: 'DELETE'
        })
        .then(() => loadTasks());
    }

    // Carregar as tarefas ao carregar a página
    loadTasks();
</script>
